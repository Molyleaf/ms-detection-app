{% extends "base.html" %}

{% block title %}Upload Data - ChemRisk AI{% endblock %}

{% block head_extra %}
<style>
    /* 漂亮的 Dropzone 样式 */
    .upload-area {
        position: relative;
        border: 2px dashed var(--sl-color-primary-200);
        border-radius: var(--sl-border-radius-large);
        background: var(--sl-color-primary-50);
        padding: 3rem 1.5rem;
        text-align: center;
        transition: all 0.2s ease;
        cursor: pointer;
    }

    .upload-area:hover {
        background: var(--sl-color-primary-100);
        border-color: var(--sl-color-primary-400);
        transform: translateY(-2px);
    }

    .upload-icon {
        font-size: 3rem;
        color: var(--sl-color-primary-400);
        margin-bottom: 1rem;
        display: block;
    }

    /* 核心技巧：将原生 Input 绝对定位并透明化，覆盖整个区域 */
    .file-input-hidden {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
        z-index: 10;
    }

    /* 文件名显示区 */
    #file-name-display {
        margin-top: 1rem;
        font-size: 0.9rem;
        color: var(--sl-color-success-600);
        font-weight: 600;
        min-height: 1.5rem;
    }
</style>

<script>
    function updateFileName(input) {
        const display = document.getElementById('file-name-display');
        if (input.files && input.files.length > 0) {
            display.innerHTML = `<sl-icon name="check-circle-fill" style="vertical-align: middle;"></sl-icon> Selected: ${input.files[0].name}`;
            document.querySelector('.upload-area').style.borderColor = 'var(--sl-color-success-500)';
            document.querySelector('.upload-area').style.background = 'var(--sl-color-success-50)';
        } else {
            display.textContent = '';
        }
    }
</script>
{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">

	<div style="text-align: center; margin-bottom: 2rem;">
		<h2 style="font-size: 1.0rem; margin-bottom: 0.5rem; color: var(--sl-color-neutral-800);">MS1 Data Screening</h2>
		<p style="color: var(--sl-color-neutral-500);">Upload your primary mass spectrometry file to detect potential risks.</p>
	</div>

	<div class="card-base" style="padding: 2rem;">
		<form action="{{ url_for('upload_ms1') }}" method="post" enctype="multipart/form-data">

			<div style="margin-bottom: 2rem;">

				<div class="upload-area">
					<input type="file" name="file" class="file-input-hidden" required accept=".xlsx, .xls, .csv" onchange="updateFileName(this)">

					<sl-icon name="cloud-arrow-up" class="upload-icon"></sl-icon>
					<div style="font-size: 1.1rem; font-weight: 500; color: var(--sl-color-primary-700);">
						Click or Drag file here
					</div>
					<div style="font-size: 0.85rem; color: var(--sl-color-neutral-500); margin-top: 0.5rem;">
						Supports .xlsx, .xls, .csv
					</div>
					<div id="file-name-display"></div>
				</div>
			</div>

			<div style="margin-bottom: 2.5rem;">
				<label style="display: block; margin-bottom: 0.8rem; font-weight: 600; color: var(--sl-color-neutral-700);">
					Step 2: Ion Mode
				</label>
				<div style="display: flex; gap: 2rem;">
					<sl-radio-group name="mode" value="positive">
						<sl-radio value="positive">Positive (+)</sl-radio>
						<sl-radio value="negative">Negative (-)</sl-radio>
					</sl-radio-group>
				</div>
			</div>

			<sl-button variant="primary" type="submit" style="width: 100%;" size="large">
				<sl-icon name="search" slot="prefix"></sl-icon>
				Start Analysis
			</sl-button>

		</form>
	</div>

</div>
{% endblock %}